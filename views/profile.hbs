<main>
    <div class="slider-area ">
        <div class="single-slider slider-height2 d-flex align-items-center">
            <div class="container">
                <div class="col-xl-12">
                    <div class="container rounded bg-white my-4 border border-danger">
                        <div class="row">
                            <div class="col-md-4 border-right">
                                <div class="d-flex flex-column align-items-center">

                                    <a href="http://google.com">
                                        <img class="rounded-circle mb-1 mt-5 Sirv" width="250px" height="250px" data-src="{{user.image}}" data-options="autostart:created">
                                    </a>

                                        <span class="font-weight-bold">{{user.firstname}} {{user.lastname}}</span>
                                        <span class="text-black-50">{{user.email}}</span>
                                        <span>{{user.image}}</span>
                                        <a class="btn btn-default btn-rounded" href="/profile/change-avatar">Change Avatar</a>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="py-3">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <h4 class="text-right">Profile</h4>
                                    </div>
                                </div>
                            <div class="col-md-12">
                                <div class="py-3">
                                    <div class="d-flex text-center justify-content-between align-items-center">
                                        <h1 class="d-flex text-center justify-content-between align-items-center">Profile</h1>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6"><label class="labels">First name</label><span class="form-control">{{user.firstname}}</span></div>
                                    <div class="col-md-6"><label class="labels">Last name</label><span class="form-control">{{user.lastname}}</span></div>
                                </div>
                                <div class="row mt-3">
                                    <div class="col-md-12 my-1"><label class="labels">Phone number</label><span class="form-control">{{user.phonenumber}}</span></div>
                                    <div class="col-md-12 my-1"><label class="labels">Address</label><span class="form-control">{{user.address}}</span></div>
                                    <div class="col-md-12 my-1"><label class="labels">Email address</label><span class="form-control">{{user.email}}</span></div>
                                    <div class="col-md-12 my-1"><label class="labels">Date of birth</label><span type="date" class="form-control">{{convertDateToString user.dob}}</span></div>
                                </div>
                                <div class="my-3 text-center">
                                    <a href="" class="btn btn-default btn-rounded" data-toggle="modal" data-target="#editProfileForm">
                                        Edit profile</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal start -->
    <div class="modal fade" id="editProfileForm" tabindex="-1" role="dialog"
         aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header text-center">
                    <h4 class="modal-title w-100 font-weight-bold">Profile Settings</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <form id="editProfile" method="post" action="/update_profile">
                    <div class="container rounded bg-white mb-3">
                    <div class="row">
                        <div class="col-md-5 border-right">
                            <div class="d-flex flex-column align-items-center justify-content">
                                <img class="rounded-circle mb-1 mt-5" width="150px" height="150px" src="{{user.image}}" >

                                <span class="font-weight-bold">{{user.firstname}} {{user.lastname}}</span>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mt-3">
                                <div class="col-md-12 my-1"><label class="labels">First name</label>
                                    <input type="text" name="firstname" class="form-control" placeholder="First name" value="{{user.firstname}}">
                                    <div class="invalid-feedback">
                                        Please enter your first name
                                    </div>
                                </div>
                                <div class="col-md-12 my-1"><label class="labels">Last name</label>
                                    <input type="text" name="lastname" class="form-control" value="{{user.lastname}}" placeholder="Last name">
                                    <div class="invalid-feedback">
                                        Please enter your last name
                                    </div>
                                </div>
                                <div class="col-md-12 my-1"><label class="labels">Phone number</label>
                                    <input type="text" name="phonenumber" class="form-control" placeholder="Phone number" value="{{user.phonenumber}}">
                                    <div class="invalid-feedback">
                                        Please enter your phone number
                                    </div>
                                </div>
                                <div class="col-md-12 my-1"><label class="labels">Address</label>
                                    <input type="text"name="address" class="form-control" placeholder="Address" value="{{user.address}}">
                                    <div class="invalid-feedback">
                                        Please enter your address.
                                    </div>
                                </div>
                                <div class="col-md-12 my-1"><label class="labels">Date of Birth</label>
                                    <input type="date" name="dob" class="form-control" value="{{time user.dob}}" placeholder="dd-mm-yyyy"/>
                                    <div class="invalid-feedback">
                                        Please enter your date of birth
                                    </div>
                                </div>
                            </div>
                            <div class="mt-4 text-center">
                                <button class="btn btn-primary profile-button" type="submit" value="submit" id="submit" formaction="/update_profile">Save</button>
                            </div>
                        </div>
                    </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <!-- Modal end -->
</main>

{{#section 'css'}}
    <link href="https://cdn.jsdelivr.net/gh/kartik-v/bootstrap-fileinput@5.2.5/css/fileinput.min.css" media="all" rel="stylesheet" type="text/css" />
{{/section}}
{{#section 'js'}}
    <script src="https://cdn.tiny.cloud/1/p1fwo21pu5sn0tp0vy4twc8487p3m1at2uussi5efjxyyylq/tinymce/5/tinymce.min.js" referrerpolicy="origin"></script>
    <script src="https://cdn.jsdelivr.net/gh/kartik-v/bootstrap-fileinput@5.2.5/js/fileinput.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-fileinput/5.2.5/themes/fa/theme.min.js" integrity="sha512-ywJxJU8HX2ZyXikj/iM4gW2vWIhnGCjfehz9kMU0oqo0GDdr3w8E2E3DZlzgIBTNKU8jovkg09pWktiw0mOFeg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <script>

        $(document).ready(function() {
            $("#input-700").fileinput({
                overwriteInitial: false,
                validateInitialCount: true,
                initialPreviewAsData: true,
                previewFileType: "image",
                browseClass: "btn btn-success",
                browseLabel: "Chọn hình",
                browseIcon: "<i class=\"bi-file-image\"></i> ",
                removeClass: "btn btn-danger",
                removeLabel: "Xóa",
                removeIcon: "<i class=\"bi-trash\"></i> ",
                uploadClass: "btn btn-info",
                uploadLabel: "Upload hình",
                uploadIcon: "<i class=\"bi-upload\"></i> ",
                uploadUrl: "/upload-avatar-profile",
                initialPreviewConfig: [
                    {
                        caption: "People-1.jpg",
                        description: 'This is a representative placeholder description for this image.',
                        size: 576237,
                        width: "120px",
                        url: "/site/file-delete",
                        key: 1
                    },
                ],
                theme: 'fa',
                language: 'vi',
                /*  allowedFileExtensions: ['jpg'],*/
            }).on('fileuploaded', function (e, params) {
                $.post("/post-avatar-sirv", {
                }, function (data) {
                    if (data) {

                    }
                });
            });
        });
    </script>
    <script>
        $("#submit").prop('disabled', true)
        let a1 = false;
        let a2 = false;
        let a3 = false;
        let a4 = false;
        let a5 = false;
        if($("[name='firstname']").val()!=""){
            a1=true;
        }
        if($("[name='lastname']").val()!=""){
            a2=true;
        }
        if($("[name='phonenumber']").val()!=""){
            a3=true;
        }
        if($("[name='address']").val()!=""){
            a4=true;
        }
        if($("[name='dob']").val()!=""){
            a5=true;
        }
        $("[name='firstname']").on("change", function () {
            if ($(this).val() == "") {
                a1 = false;
                $("[name='firstname']").addClass('is-invalid')
                $("[name='firstname']").removeClass('is-valid')
                $("#submit").prop('disabled', true)
            } else {
                a1 = true;
                $("[name='firstname']").removeClass('is-invalid')
                $("[name='firstname']").addClass('is-valid')
                if ((a1 === true) &&(a2 === true) && (a3 === true) && (a4 === true) && (a5 === true)) {
                    $("#submit").prop('disabled', false)
                }
            }
        })
        $("[name='lastname']").on("change", function () {
            if ($(this).val() == "") {
                a2 = false;
                $("[name='lastname']").addClass('is-invalid')
                $("[name='lastname']").removeClass('is-valid')
                $("#submit").prop('disabled', true)
            } else {
                a2 = true;
                $("[name='lastname']").removeClass('is-invalid')
                $("[name='lastname']").addClass('is-valid')
                if ((a1 === true) &&(a2 === true) && (a3 === true) && (a4 === true) && (a5 === true)) {
                    $("#submit").prop('disabled', false)
                }
            }
        })
        $("[name='phonenumber']").on("change", function () {
            if ($(this).val() == "") {
                a3 = false;
                $("[name='phonenumber']").addClass('is-invalid')
                $("[name='phonenumber']").removeClass('is-valid')
                $("#submit").prop('disabled', true)
            } else {
                a3 = true;
                $("[name='phonenumber']").removeClass('is-invalid')
                $("[name='phonenumber']").addClass('is-valid')
                if ((a1 === true) &&(a2 === true) && (a3 === true) && (a4 === true) && (a5 === true)) {
                    $("#submit").prop('disabled', false)
                }
            }
        })
        $("[name='address']").on("change", function () {
            if ($(this).val() == "") {
                a4 = false;
                $("[name='address']").addClass('is-invalid')
                $("[name='address']").removeClass('is-valid')
                $("#submit").prop('disabled', true)
            } else {
                a4 = true;
                $("[name='address']").removeClass('is-invalid')
                $("[name='address']").addClass('is-valid')
                if ((a1 === true) &&(a2 === true) && (a3 === true) && (a4 === true) && (a5 === true)) {
                    $("#submit").prop('disabled', false)
                }
            }
        })
        $("[name='dob']").on("change", function () {
            if ($(this).val() == "") {
                a5 = false;
                $("[name='dob']").addClass('is-invalid')
                $("[name='dob']").removeClass('is-valid')
                $("#submit").prop('disabled', true)
            } else {
                a5 = true;
                $("[name='dob']").removeClass('is-invalid')
                $("[name='dob']").addClass('is-valid')
                if ((a1 === true) &&(a2 === true) && (a3 === true) && (a4 === true) && (a5 === true)) {
                    $("#submit").prop('disabled', false)
                }
            }
        })
    </script>
{{/section}}
